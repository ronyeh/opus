<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Karplus-Strong Guitar Synth</title>
  </head>
  <body>
    <h1>Karplus-Strong Guitar Synth</h1>
    <button id="playButton">Play Middle C</button>
    <p>
      Click the button to play a single note (Middle C) synthesized using the
      Karplus-Strong algorithm with Tone.js.
    </p>
    <script src="http://unpkg.com/tone"></script>
    <script>
      // Create a new Tone.PluckSynth, which is a Karplus-Strong model
      const synth = new Tone.PluckSynth({
        dampening: 5000, // Higher value allows more high frequencies, less dampening
        resonance: 0.98, // Very high resonance for a long decay
      }).toDestination();

      // Get a reference to the button
      const playButton = document.getElementById("playButton");

      // Add an event listener to the button
      playButton.addEventListener("click", async () => {
        // Start the audio context on user gesture, as required by browsers
        await Tone.start();
        console.log("AudioContext started");

        // Trigger the synth to play Middle C ("C4").
        // Using triggerAttack allows the note to ring out and decay naturally.
        synth.triggerAttack("C3", Tone.now());
      });
    </script>
  </body>
</html>
